# 相邻座位

给定$n$个男性，$m$个女性，它们的座位随机排成一排。求分配为异性的相邻座位对数的数学期望。

## 解答

### 考虑每个相邻座位

一共有$n + m - 1$个相邻座位对。

对于每个相邻座位对，我们要考虑的都是：“从$n$个男性和$m$个女性中，选两个人放这个相邻座位的左右两边，这两个人是否为异性”这件事。

但是，这样子很有可能错，所以这种做法还是算了。

### DP解

记$f_{i,j}$为只考虑前$i + j$个座位，在有$i$个男性，$j$个女性，分配为异性的相邻座位对数的数学期望。我们对第$1$个座位分类讨论：

1. 若分配给了男性，
   * 若该男性的右边是女性（概率为$\frac{j}{i + j - 1}$），则$f_{i,j} = f_{i-1,j} + 1$；
   * 若该男性的右边是男性，则$f_{i,j} = f_{i-1,j}$。
2. 若分配给了女性，同理。

综上，状态转移方程如下：

$$
f_{i,j} = \frac{i}{i + j} \left(f_{i-1,j} + \frac{j}{i + j - 1} \right) +\frac{j}{i + j} \left(f_{i,j-1} + \frac{i}{i + j - 1} \right)
$$

初值条件为$f_{i,0} = f_{0,j} = 0$。
