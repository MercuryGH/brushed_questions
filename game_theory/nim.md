# NIM游戏

## 巴什博奕

初始时有$n$个石子。两玩家轮流取石子，每次可取的石子数为集合$\{1,2,\dots, k\}$中的任意元素（同时该元素不能大于当前石子数）。取了最后一块石子的玩家获胜。

证明：在玩家每一步均为最优解的情况下，后手获胜当且仅当$(k+1) | n$。

### 证明

记$f_i$表示当前场上有$i$个石子，且正要取石子的玩家是否能获胜。先计算几个简单的状态：

* $\forall i \in [1,k], f_i = 1$；
* $f_{k+1} = 0$。

这是因为，正要取石子的玩家可以一口气取完至多$k$个石子然后获胜；或者取不完，然后让另一名玩家取完，然后其获胜。

进一步地，我们发现若存在$f_{i-j}(j \in [1,k])$为$0$，那么$f_i$下正要取石子的玩家就可以让状态转移到$f_{i-j}$，从而让对手失败；否则，当前玩家失败。

因此，状态转移方程为：对任意$i > k$，都有

$$
f_i = {\bigvee_{j=1}^k \overline{f_{i-j}}} = \overline{\bigwedge_{j=1}^k {f_{i-j}}}.
$$

在推导状态转移方程时，我们发现了规律性：只有能被$k+1$整除的$i$，才有$f_i = 0$，容易通过数学归纳法证明。

故在玩家每一步均为最优解的情况下，先手不能获胜，当且仅当$(k+1)$不能整除$n$，证毕。
