# 洗牌算法

给定序列$a_n$，请实现算法等概率地取得$a_n$的每个全排列。

提示：你可以调用 `random(k)`函数获取$[1,k]$中均匀分布的正整数。

## 解答

Knuth洗牌算法，时间复杂度$O(n)$。

我们考虑结果序列$b_n$在下标$[1,n]$中应该填入$a_n$中的什么数。

考虑如下的策略：对于下标$i$，我们随机取$[i, n]$中的一个数$k$，让$a_i, a_k$交换。对每一个$i \in [1,n]$顺序执行这样的操作，我们就等概率地取得了$a_n$的全排列。

下面证明这个算法的正确性。我们只需证明：

* 对于结果数组$b_n$的每一个位置$i$，出现$a_k$的概率是否均等为$\frac{1}{n}$。

对于$b_1$，由交换的等概率性，显然$b_1$等概率地取得了$a_k, k \in [1,n]$。

对于$b_2$，由于$b_1$已经确定，我们考虑从剩余的$n-1$个元素中进行交换选择。由条件概率公式，任意一个元素出现的概率为$\frac{n-1}{n} \cdot \frac{1}{n-1} = \frac{1}{n}$。

归纳下去，容易证明策略的正确性。
