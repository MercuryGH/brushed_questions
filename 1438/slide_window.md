# 极差子序列

给定序列$a_n$和非负整数$k$，请找出最长的区间$[i,j]$，使得$a_{i:j}$的极差不超过$k$。

## 解答

### 朴素DP

维护$f_{i,j}$为区间$[i,j]$的最大值，$g_{i,j}$为区间$[i,j]$的最小值，然后取最长的区间，$f_{i,j} - g_{i,j}  \leq k$。时间复杂度$O(n^2)$。

### 滑动窗口

利用滑动窗口贪心不漏解的天然性质，我们进行如下操作：

1. 先滑右端点，直到窗口内的极差大于$k$；
2. 滑左端点，直到窗口内的极差小于或等于$k$；
3. 回到1，直到右端点超过范围。

在此过程中，我们不断更新答案（获取滑动窗口内的极差）。

那么，如何获取极差？简单的想法是，维护一个滑动窗口内的 `multiset`（或者 `map`），即可在$O(\log n)$时间内获取极差，故总体时间复杂度为$O(n \log n)$。

又考虑到“滑动窗口内的最大值”这道题是单调队列的例题，故我们可以用两个单调队列，一个维护滑动窗口内的最大值，一个维护最小值，即可在$O(1)$时间内获取极差，故总体时间复杂度为$O(n)$。
