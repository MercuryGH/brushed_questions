# 又一个01背包变体

现有$m$元预算，$n$件商品，商品集为$T$，第$i$件商品的原价为$a_i$，现价为$b_i$，快乐值为$w_i$。请在选择商品的集合$S \subseteq T$满足

$$
\sum_{i \in S} b_i \leq m \tag{1}
$$

**或者**

$$
\sum_{i \in S} (a_i - b_i) \geq \sum_{i \in S} b_i - m \tag{2}
$$

的情况下，最大化$\sum_{i \in S} w_i$。

## 解答

原约束条件即为

$$
\sum_{i \in S} b_i \leq \max\left(m, \frac{\sum_{i \in S} a_i + m}{2} \right)
$$

然而因为右边的$\sum_{i \in S}a_i$而无法DP（或者是我太菜了想不到DP方案）。

观察一下；

1. 若某个商品满足$a_i - b_i \geq b_i$，由式（2），这个商品对（2）的成立有贡献，而且可以给预算贡献$a_i - (b_i + b_i)$这么多金额，还可以白嫖快乐值$w_i$。
2. 否则，$a_i - b_i < b_i$，那么这个商品对式（2）的成立有损耗，价格相当于$b_i - (a_i - b_i)$，快乐值为$w_i$。

背包容量就是$m$与所有情况1所能获得的超预算金额，物品则是情况2的所有物品，然后做01背包取最大快乐值即可。
