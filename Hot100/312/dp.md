# 戳气球

本题类似于“矩阵乘法的最少次数”。

给定序列$a_n$，保证其中**所有元素为非负整数**。你可以对序列中的任何一个元素$a_i$进行如下操作：

1. 删除之，然后获得$a_{i-1} \cdot a_i \cdot a_{i+1}$点分数。若$k = i-1$或$k=i+1$越界，则$a_k$为$1$。

请给出直到$a_n$被完全删除为止，所能获得的最多分数之和。

## 解答

区间DP典型题了。

令$f_{i,j}$为**两头闭区间子序列**$a_{i:j}$完全删除，所能获得的最多分数之和，那么答案在$f_{0:n+1}$。

考虑$a_{i:j}$中**最后一个被删除**的元素$a_k$，则$k \in (i,j)$：

* 若$j - i \leq 1$，则区间里面根本没有元素，我们令$f_{i,j} = 0$。
* 若$j - i > 1$，则可以取$a_k$。因为$a_k$是区间$(i,j)$中最后一个被删除的，所以删除它恰好可以获得$a_i \cdot a_k \cdot a_j$的分数！因此状态转移方程为

  $$
  f_{i,j} = \max_{k \in (i,j)}(f_{i,k} + (a_i \cdot a_k \cdot a_j) + f_{k,j})
  $$
