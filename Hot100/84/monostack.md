# 柱状图中最大的矩形

求在柱状图中，能够勾勒出来的矩形的最大面积。

## 解答

### 暴力

对每个离散柱，以其高度为矩形的高度，向左右扩散至无法扩散为止，更新答案。最坏时间复杂度$O(n^2)$。

其实用到了一点很简单的贪心，策略明显正确。

### 单调栈

维护一个单调递增栈，线性扫描原序列，操作规则如下：

1. 如果扫描到的新元素比栈顶元素大（或者栈为空），则入栈；
2. 否则，弹栈直到新元素比栈顶元素大（或者栈为空），入栈。

容易证明，对该单调（递增）栈，其满足如下性质：

1. 栈内的元素始终递增。
2. 当有元素出栈时，待入栈元素是出栈元素在原序列中向后找，第一个比其小的元素。
3. 当有元素出栈后，新的栈顶元素是出栈元素在原序列中向前找，第一个比其小的元素。

注意到，对每个离散柱，扩散过程相当于找出栈元素的左右方向第一个比其小的元素。使用单调栈，该过程的时间复杂度可以降低为$O(1)$，因此整体时间复杂度降低为$O(n)$。
