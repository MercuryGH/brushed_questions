# 打家劫舍 I

记$f_i$为只考虑前$i$家房屋，所能达到的最大金额。考虑是否偷第$i$家房屋来得到状态转移：

* 若偷，则第$i-1$家房屋不能偷，其他都能偷。因此$f_i = f_{i-2} + a_i$。
* 若不偷，则$f_i = f_{i-1}$。

因此

$$
f_{i} = \max(f_{i-2} + a_i, f_{i - 1}).
$$

初始条件为$f_1 = a_1, f_2 = \max(a_1, a_2)$。

这个方程容易使用滚动数组优化。

### 与打家劫舍 III 结合更密切的DP

记$f_{i,j}$为只考虑前$i$家房屋，在偷（$j=1$）或不偷（$j=0$）的情况下，所能达到的最大金额。那么答案在$\max(f_{n, 0}, f_{n, 1})$。状态转移方程为

$$
f_{i, 0} = \max(f_{i-1, 0}, f_{i-1, 1}), \\
f_{i, 1} = f_{i-1, 0} + a_i.
$$

初始条件为$f_{1,0} = 0, f_{1,1} = a_1$。

# 打家劫舍 II

现在，所有的房屋围成一圈，而非排成一列。

我们用一个巧妙的变换，将它转换为 打家劫舍 I 排成一列的情况。

考虑原始问题有$n$家房屋：

* 若偷第一家，则最后一家不能偷，于是变成 打家劫舍 I 的子列$a_{1:n-1}$的问题。
* 若不偷第一家，则最后一家能偷，于是变成 打家劫舍 I 的子列$a_{2:n}$的问题。

取这两种情况的最大值即可。

# 打家劫舍 III

现在，房屋排成了一个二叉树。不能偷两个直接相连的结点。

这是树形DP的入门题。

考虑$f_{\text{node}, j}$表示只考虑以$\text{node}$为根结点的树，在偷$\text{node}$（$j=1$）或不偷（$j=0$）的情况下，所能达到的最大金额。那么答案在$\max(f_{\text{root}, 0}, f_{\text{root}, 1})$。

考虑状态转移。如果不偷，那就取决于其左 + 右孩子的选择：

$$
f_{\text{node}, 0} = \max(f_{\text{node.left},0}, f_{\text{node.left},1}) + \max(f_{\text{node.right},0}, f_{\text{node.right},1})
$$

如果偷，那么左右都不能偷：

$$
f_{\text{node}, 1} = \text{node.val} + f_{\text{node.left},0} + f_{\text{node.right},0}
$$

**终结**条件为$f_{\text{null}, j}=0$。

树形DP大多采用后序遍历，本题也不例外。可以从状态转移方程中看出来，结果需要从左孩子的结果和右孩子的结果得到，因此我们必须用后序遍历完成DP。
