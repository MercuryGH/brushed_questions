# 下次股票上涨还需几天

给定序列$a_n$，请对其中的每个元素$a_i$，找出最小的$j, j\in(i, n]$，满足$a_j > a_i$。

具体而言，你的目标是实现一个函数$f(i)$，其输入为$i \in [1,n]$，输出为上文定义的$a_i$对应的$j$。对于没有这样的$j$的情况，$f$输出$0$。请给出序列$\{f(1), \dots, f(n)\}$。

## 解答

暴力法$O(n^2)$，显然不够看。

考虑延迟判定$f$的值，维护一个**最小栈**，其存放一个$(下标, 值)$元组，即可在$O(n)$时间内完成。

对于例子$a_n = \{3,4,5,11,9,12,16,13\}$，当$i=5$时，算法运行状态如下：

| $a_n$ | 3 | 4 | 15 | 11 | 9 | 12 | 16 | 13 |
| :-----: | - | - | -- | -- | - | -- | -- | -- |
|  $f$  | 1 | 1 | ?  | ?  | ? |    |    |    |

此时最小栈内的元素，从顶到底分别为$\{(5, 9), (4, 11), (3, 15)\}$。可以看出来，栈内元素的值（元组中的第二个值）必然是自顶到底，从小到大排列的，故称之为最小栈。

然后，$i=6$时：

* 算法发现$12$大于栈顶元素$9$，于是弹出之，然后覆写$f_{5}=1$；
* 发现$12$大于栈顶元素$11$，于是弹出之，然后覆写$f_{4}=2$；
* 发现$12 \leq 15$，压入之。

随后，进入下一轮迭代$i=7$。在这一轮结束后，栈内只剩$\{(7,16)\}$。

最终答案为$\{1,1,4,2,1,1,0,0\}$。

**小空间优化**

如果$a_n$用数组存放，由于数组支持随机访问，故栈中实际上不需要存放第二个值，这是因为可以通过过下标$i$直接访问$a_i$。故栈内直接存放下标即可（如果序列$a_n$用链表存放，则仍然需要这个空间）。
