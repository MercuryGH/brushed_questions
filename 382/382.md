# 链表随机抽样问题

> Leetcode 283

已知一个单向链表有$n$个元素，且$n$很大。如何科学地设计`random()`函数，等概率地随机取出该链表中的一个元素？

## 解答

设原链表为$L_{1,n}$，从其第$i$个元素数到最后的子链表为$L_{i,n}$。我们需要从状态$L_{1,n}$变化到$L_{n,n}$，直到选出其中一个元素为止。

可以证明，使用策略“在状态$L_{i,n}$中以概率$\frac{1}{i}$选取当前元素，并覆盖已选择的元素”，就可以做到$L_{1,n}$的每个元素等概率选取。

证明如下：
$$
P(选中的是i号元素) = P(在状态L_{i,n}中，选中了当前元素，且最终没有被后面的元素覆盖) = \frac{1}{i} \cdot \frac{i}{i + 1}\cdot \dots \cdot \frac{n-1}{n} = \frac{1}{n}.
$$
证毕。

该策略的优势在于，不需要预先知道$n$的值，也不需要额外空间来运行算法。